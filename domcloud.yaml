source: https://github.com/robertmdlzs01/eventudev.git

# Configuración corregida para DomCloud - Next.js con Backend
features:
  - node lts
  - mysql

nginx:
  root: public_html/public
  passenger:
    enabled: "on"

app_env: "production"
# Comando corregido para usar nuestro script personalizado
app_start_command: env PORT=$PORT node start-production.js

# Comandos de despliegue
commands:
  # Instalar dependencias del frontend
  - NPM=`which npm`
  - $NPM install
  
  # Construir la aplicación Next.js
  - $NPM run build
  
  # Instalar dependencias del backend
  - cd backend && $NPM install --production
  
  # Crear archivo .env si no existe
  - "[ -f .env ] || touch .env"
  - "[ -f backend/.env ] || touch backend/.env"
  
  # Configurar variables de entorno para producción
  - echo "NODE_ENV=production" >> .env
  - echo "NEXT_PUBLIC_API_URL=https://eventu.mnz.dom.my.id/api" >> .env
  - echo "NODE_ENV=production" >> backend/.env
  - echo "PORT=$PORT" >> backend/.env
  - echo "FRONTEND_URL=https://eventu.mnz.dom.my.id" >> backend/.env
  - echo "BACKEND_URL=http://localhost:$PORT" >> .env
  
  # Configurar base de datos MySQL (descomenta y ajusta según tu configuración)
  # - echo "DB_HOST=localhost" >> backend/.env
  # - echo "DB_USER=$USERNAME" >> backend/.env
  # - echo "DB_PASSWORD=$MYPASSWD" >> backend/.env
  # - echo "DB_NAME=$DATABASE" >> backend/.env
  # - echo "DB_PORT=3306" >> backend/.env

# Configuración adicional para Next.js
passenger_app_root: public_html