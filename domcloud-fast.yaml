source: https://github.com/robertmdlzs01/eventudev.git

features:
  - node lts
  - mysql

nginx:
  root: public_html/public
  passenger:
    enabled: "on"

app_env: "production"
app_start_command: "env PORT=$PORT node dist/src/index-fast.js"

commands:
  - NPM=`which npm`
  - $NPM install
  - $NPM run build
  - cd backend && $NPM install --production --no-optional
  - "[ -f .env ] || touch .env"
  - "[ -f backend/.env ] || touch backend/.env"
  - echo "NODE_ENV=production" >> .env
  - echo "NEXT_PUBLIC_API_URL=https://eventu.mnz.dom.my.id/api" >> .env
  - echo "NODE_ENV=production" >> backend/.env
  - echo "PORT=$PORT" >> backend/.env
  - echo "FRONTEND_URL=https://eventu.mnz.dom.my.id" >> backend/.env
  - echo "DB_TYPE=postgresql" >> backend/.env
  - echo "DB_HOST=localhost" >> backend/.env
  - echo "DB_PORT=5432" >> backend/.env
  - echo "DB_NAME=eventu_db" >> backend/.env
  - echo "DB_USER=postgres" >> backend/.env
  - echo "DB_PASSWORD=Eventu321" >> backend/.env
  - echo "BACKEND_URL=http://localhost:$PORT" >> .env
  - cp backend/config.production.env backend/.env
